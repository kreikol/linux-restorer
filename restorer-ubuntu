#!/bin/bash
#
# 1er parÃ¡metro: nombre del repositorio de los dotfiles
# 2o parÃ¡metro: ruta de la clave ssh de GitHub
#

echo 'ğŸ”„ >> Actualizamos el repositorio apt' 
sudo apt update -y

echo 'âœ… >> Actualizmos los paquetes actuales' 
sudo apt upgrade -y

echo '>'
echo 'ğŸ“‚ > Vamos con los dotfiles' 

export DOTFILES_PATH="$HOME/.dotfiles"

# Cargamos la clave ssh de GitHub
echo 'ğŸ”‘ >> Cargando clave SSH...'
eval "$(ssh-agent -s)"
ssh-add "$2"

# Clonamos el repositorio indicado para los dotfiles 
echo ' Cloning...'
git clone git@github.com:kreikol/$1.git $DOTFILES_PATH

cd $DOTFILES_PATH

git submodule update --init --recursive 

export DOTLY_INSTALLER=true
export DOTLY_PATH="$DOTFILES_PATH/modules/dotly"

echo 'ğŸš€ > Go to install dotly'

$DOTLY_PATH/bin/dot package add docpars
$DOTLY_PATH/bin/dot self install

echo '>'
read -p "RestauraciÃ³n terminada, presione una tecla para reiniciar.."

